<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clipping Project ‚Äî Dynamic Subtitles</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=Bangers&family=Bebas+Neue&family=Anton&family=Oswald:wght@700&family=Creepster&family=Permanent+Marker&family=Comic+Neue:wght@700&family=Bungee&family=Poppins:wght@700;800&family=Montserrat:wght@700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>

<!-- ‚ïê‚ïê‚ïê Header ‚ïê‚ïê‚ïê -->
<header>
  <h1>Clipping Project</h1>
  <div class="status-pills">
    <div class="pill" id="gpu-pill">
      <span class="dot" id="gpu-dot"></span>
      <span id="gpu-label">Checking GPU‚Ä¶</span>
    </div>
    <div class="pill" id="ffmpeg-pill">
      <span class="dot" id="ffmpeg-dot"></span>
      <span id="ffmpeg-label">FFmpeg‚Ä¶</span>
    </div>
  </div>
</header>

<!-- ‚ïê‚ïê‚ïê Upload View ‚ïê‚ïê‚ïê -->
<div id="upload-view" class="view active">
  <div class="upload-hero">
    <h2>Subtitle your clips in seconds</h2>
    <p>Drop a video or audio file to auto-transcribe and style dynamic subtitles</p>
  </div>
  <div class="upload-card-wrap">
  <div class="upload-card" id="upload-card">
    <input type="file" id="file-input"
           accept=".mp4,.mkv,.avi,.mov,.webm,.mp3,.wav,.flac,.m4a,.ogg" />
    <span class="upload-icon">üé¨</span>
    <h2>Drop a video or audio file</h2>
    <p>MP4, MKV, AVI, MOV, WEBM, MP3, WAV &mdash; up to 500 MB</p>
  </div>
  </div>
  <div class="transcribe-progress" id="transcribe-progress">
    <div class="progress-box">
      <div class="progress-label">
        <span id="progress-text">Transcribing‚Ä¶</span>
        <span id="progress-file"></span>
      </div>
      <div class="progress-track">
        <div class="progress-fill"></div>
      </div>
    </div>
  </div>

  <!-- Previously Uploaded Files -->
  <div class="previous-uploads" id="previous-uploads">
    <div class="prev-uploads-header">
      <h3>Previously Uploaded</h3>
      <button class="btn btn-outline btn-sm" onclick="loadPreviousUploads()">‚Üª Refresh</button>
    </div>
    <div id="uploads-list" class="uploads-list">
      <div class="uploads-loading">Loading‚Ä¶</div>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê Editor View ‚ïê‚ïê‚ïê -->
<div id="editor-view" class="view">
  <!-- Main Area: Video + Transcript -->
  <div class="main-area">
    <!-- Video + Subtitle Preview -->
    <div class="video-panel" id="video-container">
      <div class="subtitle-container" id="subtitle-box">
          <video id="editor-video" controls></video>
          <div class="subtitle-overlay pos-bottom" id="subtitle-preview"></div>
      </div>
    </div>
    
    <!-- Editable Transcript -->
    <div class="transcript-panel">
      <div class="transcript-header">
        <h3>üìù Transcript</h3>
        <span class="transcript-meta" id="word-count"></span>
      </div>
      <div class="transcript-toolbar">
        <button class="toolbar-btn undo-btn" id="undo-btn" onclick="undoAction()" disabled title="Undo last action">
          ‚Ü© Undo <span class="undo-count" id="undo-count" style="display:none">0</span>
        </button>
        <div class="toolbar-separator"></div>
        <button class="toolbar-btn merge-btn" id="merge-btn" onclick="mergeSelectedWords()" disabled title="Select 2+ adjacent words to merge">
          ‚õì Merge Words
        </button>
      </div>
      <div class="word-list" id="word-list"></div>
      <div class="transcript-footer">
        <button class="btn btn-outline btn-sm" onclick="newTranscription()">‚¨Ü New File</button>
        <span style="flex:1"></span>
        <span style="font-size:0.7rem; color:var(--text-dim);">Click to seek ‚Ä¢ Dbl-click to edit ‚Ä¢ Shift+click to select range</span>
      </div>
    </div>
  </div>

  <!-- Right Sidebar -->
  <div class="sidebar">
    <div class="sidebar-tabs">
      <button class="sidebar-tab active" data-tab="style" onclick="switchTab('style')">üé® Style</button>
      <button class="sidebar-tab" data-tab="groups" onclick="switchTab('groups')">üì¶ Groups</button>
    </div>
    
    <div class="sidebar-content">
      <!-- Style Tab -->
      <div class="tab-panel active" id="tab-style">
        <!-- Subtitle Mode Section (moved to top) -->
        <div class="style-section mode-section">
          <div class="style-section-title">Subtitle Mode</div>
          <div class="mode-toggle-row">
            <button class="mode-toggle-btn active" id="mode-dynamic" onclick="setSubtitleMode('dynamic')">
              <span class="mode-icon">üî§</span>
              <span class="mode-label">Dynamic</span>
              <span class="mode-desc">Per-word highlighting</span>
            </button>
            <button class="mode-toggle-btn" id="mode-static" onclick="setSubtitleMode('static')">
              <span class="mode-icon">üìù</span>
              <span class="mode-label">Static</span>
              <span class="mode-desc">Sentence at a time</span>
            </button>
          </div>
        </div>

        <!-- Dynamic Mode Presets Section -->
        <div class="style-section preset-section dynamic-only" id="dynamic-presets-section">
          <div class="style-section-title">Dynamic Presets</div>
          <div class="preset-grid">
            <button class="preset-btn active" data-preset="vtuber" onclick="applyDynamicPreset('vtuber')">
              <span class="preset-icon">üî•</span>
              <span class="preset-name">VTuber Pop</span>
            </button>
            <button class="preset-btn" data-preset="neon" onclick="applyDynamicPreset('neon')">
              <span class="preset-icon neon-text">NEON</span>
              <span class="preset-name">Neon</span>
            </button>
            <button class="preset-btn" data-preset="anime" onclick="applyDynamicPreset('anime')">
              <span class="preset-icon anime-text">„Ç¢„Éã„É°</span>
              <span class="preset-name">Anime Bold</span>
            </button>
            <button class="preset-btn" data-preset="clean" onclick="applyDynamicPreset('clean')">
              <span class="preset-icon">Clean</span>
              <span class="preset-name">Clean</span>
            </button>
            <button class="preset-btn" data-preset="retro" onclick="applyDynamicPreset('retro')">
              <span class="preset-icon retro-text">GAME</span>
              <span class="preset-name">Retro</span>
            </button>
            <button class="preset-btn" data-preset="idol" onclick="applyDynamicPreset('idol')">
              <span class="preset-icon">‚ú®</span>
              <span class="preset-name">Idol</span>
            </button>
          </div>
        </div>

        <!-- Static Mode Presets Section -->
        <div class="style-section preset-section static-only" id="static-presets-section" style="display: none;">
          <div class="style-section-title">Static Presets</div>
          <div class="preset-grid">
            <button class="preset-btn static-preset active" data-preset="classic" onclick="applyStaticPreset('classic')">
              <span class="preset-icon">üé¨</span>
              <span class="preset-name">Classic</span>
            </button>
            <button class="preset-btn static-preset" data-preset="cinematic" onclick="applyStaticPreset('cinematic')">
              <span class="preset-icon">üé•</span>
              <span class="preset-name">Cinematic</span>
            </button>
            <button class="preset-btn static-preset" data-preset="minimal" onclick="applyStaticPreset('minimal')">
              <span class="preset-icon">‚Äî</span>
              <span class="preset-name">Minimal</span>
            </button>
            <button class="preset-btn static-preset" data-preset="neonStatic" onclick="applyStaticPreset('neonStatic')">
              <span class="preset-icon neon-text">GLOW</span>
              <span class="preset-name">Neon Glow</span>
            </button>
            <button class="preset-btn static-preset" data-preset="retrostatic" onclick="applyStaticPreset('retrostatic')">
              <span class="preset-icon retro-text">VHS</span>
              <span class="preset-name">Retro VHS</span>
            </button>
            <button class="preset-btn static-preset" data-preset="elegant" onclick="applyStaticPreset('elegant')">
              <span class="preset-icon">‚ú¶</span>
              <span class="preset-name">Elegant</span>
            </button>
          </div>
        </div>

        <!-- Emotion Presets Section (Dynamic only) -->
        <div class="style-section emotion-section dynamic-only">
          <div class="style-section-title">Emotion Styles</div>
          <div class="emotion-grid">
            <button class="emotion-btn" data-emotion="angry" onclick="applyEmotion('angry')">üò° Angry</button>
            <button class="emotion-btn" data-emotion="creepy" onclick="applyEmotion('creepy')">üëª Creepy</button>
            <button class="emotion-btn" data-emotion="shy" onclick="applyEmotion('shy')">üò≥ Shy</button>
            <button class="emotion-btn" data-emotion="gloomy" onclick="applyEmotion('gloomy')">üòî Gloomy</button>
            <button class="emotion-btn" data-emotion="bright" onclick="applyEmotion('bright')">‚òÄÔ∏è Bright</button>
            <button class="emotion-btn" data-emotion="energetic" onclick="applyEmotion('energetic')">‚ö° Energetic</button>
            <button class="emotion-btn" data-emotion="obnoxious" onclick="applyEmotion('obnoxious')">ü§™ Obnoxious</button>
            <button class="emotion-btn" data-emotion="romantic" onclick="applyEmotion('romantic')">üíï Romantic</button>
          </div>
          <div class="emotion-info" id="emotion-info">Select words, then click an emotion to apply</div>
        </div>

        <!-- Font Section -->
        <div class="style-section">
          <div class="style-section-title">Font</div>
          <div class="style-row">
            <label>Family</label>
            <select id="ctrl-fontfamily">
              <option value="Bangers">Bangers (VTuber)</option>
              <option value="Impact">Impact</option>
              <option value="Arial Black">Arial Black</option>
              <option value="Bebas Neue">Bebas Neue</option>
              <option value="Montserrat">Montserrat</option>
              <option value="Roboto">Roboto</option>
              <option value="Open Sans">Open Sans</option>
              <option value="Oswald">Oswald</option>
              <option value="Anton">Anton</option>
              <option value="Poppins">Poppins</option>
              <option value="Lato">Lato</option>
              <option value="Creepster">Creepster (Horror)</option>
              <option value="Permanent Marker">Permanent Marker</option>
              <option value="Comic Neue">Comic Neue</option>
              <option value="Bungee">Bungee</option>
            </select>
          </div>
          <div class="style-row">
            <label>Size</label>
            <input type="range" min="20" max="200" value="80" id="ctrl-fontsize" />
            <span class="range-val" id="val-fontsize">80</span>
          </div>
          <div class="style-row">
            <label>Bold</label>
            <input type="checkbox" checked id="ctrl-bold" />
            <span style="width:20px"></span>
            <label>Italic</label>
            <input type="checkbox" id="ctrl-italic" />
          </div>
          <div class="style-row">
            <label>UPPER</label>
            <input type="checkbox" checked id="ctrl-uppercase" />
          </div>
        </div>
        
        <!-- Colors Section -->
        <div class="style-section">
          <div class="style-section-title">Colors</div>
          <div class="style-row dynamic-only" id="highlight-color-row">
            <label>Highlight</label>
            <input type="color" value="#FFD700" id="ctrl-highlight" />
            <label style="margin-left:0.5rem">Normal</label>
            <input type="color" value="#FFFFFF" id="ctrl-textcolor" />
          </div>
          <div class="style-row static-only" id="text-color-row" style="display: none;">
            <label>Text Color</label>
            <input type="color" value="#FFFFFF" id="ctrl-textcolor-static" />
          </div>
          <div class="style-row">
            <label>Outline</label>
            <input type="color" value="#000000" id="ctrl-outlinecolor" />
            <label style="margin-left:0.5rem">Shadow</label>
            <input type="color" value="#000000" id="ctrl-shadowcolor" />
          </div>
        </div>
        
        <!-- Effects Section -->
        <div class="style-section">
          <div class="style-section-title">Effects</div>
          <div class="style-row">
            <label>Outline</label>
            <input type="range" min="0" max="12" value="4" id="ctrl-outline" />
            <span class="range-val" id="val-outline">4</span>
          </div>
          <div class="style-row">
            <label>Shadow</label>
            <input type="range" min="0" max="10" value="2" id="ctrl-shadow" />
            <span class="range-val" id="val-shadow">2</span>
          </div>
          <div class="style-row">
            <label>Glow</label>
            <input type="range" min="0" max="20" value="0" id="ctrl-glow" />
            <span class="range-val" id="val-glow">0</span>
          </div>
          <div class="style-row">
            <label>Glow Color</label>
            <input type="color" value="#FFD700" id="ctrl-glowcolor" />
          </div>
          <div class="style-row dynamic-only" id="scale-row">
            <label>Scale %</label>
            <input type="range" min="100" max="150" value="100" id="ctrl-scale" />
            <span class="range-val" id="val-scale">100</span>
          </div>
        </div>
        
        <!-- Dynamic Animation Section -->
        <div class="style-section dynamic-only" id="animation-section">
          <div class="style-section-title">Word Animation</div>
          <div class="style-row">
            <label>Highlight</label>
            <select id="ctrl-animation">
              <option value="color-only" selected>Color Only</option>
              <option value="scale">Scale</option>
              <option value="bounce">Bounce</option>
              <option value="none">None</option>
            </select>
          </div>
          <div class="style-row">
            <label>Group Anim</label>
            <select id="ctrl-groupanimation">
              <option value="none" selected>None</option>
              <option value="fade-in">Fade In</option>
              <option value="slide-up">Slide Up</option>
              <option value="slide-down">Slide Down</option>
              <option value="pop-in">Pop In</option>
              <option value="typewriter">Typewriter</option>
            </select>
          </div>
          <div class="style-row">
            <label>Anim Speed</label>
            <input type="range" min="100" max="500" value="200" id="ctrl-animspeed" />
            <span class="range-val" id="val-animspeed">200</span><span style="font-size:0.7rem;color:var(--text-dim)">ms</span>
          </div>
        </div>

        <!-- Static Animation Section -->
        <div class="style-section static-only" id="static-animation-section" style="display: none;">
          <div class="style-section-title">Sentence Animation</div>
          <div class="style-row">
            <label>Entrance</label>
            <select id="ctrl-sentenceanimation">
              <option value="none">None</option>
              <option value="fade-in" selected>Fade In</option>
              <option value="slide-up">Slide Up</option>
              <option value="slide-down">Slide Down</option>
              <option value="pop-in">Pop In</option>
              <option value="typewriter">Typewriter</option>
            </select>
          </div>
          <div class="style-row">
            <label>Anim Speed</label>
            <input type="range" min="100" max="500" value="300" id="ctrl-staticanimspeed" />
            <span class="range-val" id="val-staticanimspeed">300</span><span style="font-size:0.7rem;color:var(--text-dim)">ms</span>
          </div>
        </div>

        <!-- Spacing Section -->
        <div class="style-section">
          <div class="style-section-title">Spacing</div>
          <div class="style-row">
            <label>Letter Spc</label>
            <input type="range" min="0" max="20" value="0" id="ctrl-letterspacing" />
            <span class="range-val" id="val-letterspacing">0</span>
          </div>
          <div class="style-row">
            <label>Word Gap</label>
            <input type="range" min="0" max="8" value="0" id="ctrl-wordgap" />
            <span class="range-val" id="val-wordgap">0</span>
          </div>
        </div>
        
        <!-- Position Section -->
        <div class="style-section">
          <div class="style-section-title">Position</div>
          <div class="style-row">
            <label>Vertical</label>
            <select id="ctrl-position">
              <option value="bottom" selected>Bottom</option>
              <option value="center">Center</option>
              <option value="top">Top</option>
            </select>
          </div>
          <div class="style-row">
            <label>Margin V</label>
            <input type="range" min="0" max="200" value="60" id="ctrl-marginv" />
            <span class="range-val" id="val-marginv">60</span>
          </div>
          <div class="style-row">
            <label>Margin H</label>
            <input type="range" min="0" max="200" value="10" id="ctrl-marginh" />
            <span class="range-val" id="val-marginh">10</span>
          </div>
        </div>
        
        <!-- Per-Word Style Panel -->
        <div class="word-style-panel hidden" id="word-style-panel">
          <div class="word-style-header">
            <h4>Word Style Override</h4>
            <button class="btn btn-outline btn-sm" onclick="clearWordStyles()">Clear</button>
          </div>
          <div class="selected-words-info" id="selected-words-info">No words selected</div>
          <div class="style-row">
            <label>Highlight</label>
            <input type="color" value="#FFD700" id="word-highlight" />
          </div>
          <div class="style-row">
            <label>Normal</label>
            <input type="color" value="#FFFFFF" id="word-normal" />
          </div>
          <div class="style-row">
            <label>Font Size</label>
            <input type="number" value="" placeholder="‚Äì" id="word-fontsize" />
          </div>
          <div class="style-row">
            <label>Outline</label>
            <input type="color" value="#000000" id="word-outline" />
          </div>
          <div class="style-row">
            <button class="btn btn-primary btn-sm" onclick="applyWordStyle()" style="width:100%">Apply to Selected</button>
          </div>
        </div>
      </div>
      
      <!-- Groups Tab -->
      <div class="tab-panel" id="tab-groups">
        <div class="groups-header">
          <h4>Word Groups</h4>
          <div class="groups-mode-toggle">
            <button class="active" id="mode-auto" onclick="setGroupMode('auto')">Auto</button>
            <button id="mode-custom" onclick="setGroupMode('custom')">Custom</button>
          </div>
        </div>
        
        <!-- Auto mode controls -->
        <div id="auto-group-controls">
          <div class="style-row">
            <label>Words/group</label>
            <input type="range" min="1" max="10" value="4" id="ctrl-wpg" />
            <span class="range-val" id="val-wpg">4</span>
          </div>
        </div>
        
        <!-- Custom mode controls -->
        <div id="custom-group-controls" style="display:none;">
          <div style="margin-bottom:0.75rem; display:flex; gap:0.5rem;">
            <button class="btn btn-outline btn-sm" onclick="autoGenerateGroups()">Reset to Auto</button>
          </div>
          <div class="group-list" id="group-list"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Bottom Bar -->
  <div class="bottom-bar">
    <button class="btn btn-primary" id="render-btn" onclick="startRender()">
      üé¨ Render Video
    </button>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê Render Overlay ‚ïê‚ïê‚ïê -->
<div class="render-overlay" id="render-overlay">
  <div class="render-modal">
    <h3 id="render-title">Rendering‚Ä¶</h3>
    <div class="progress-track" style="margin-top: 1rem;">
      <div class="progress-fill" id="render-progress-fill"></div>
    </div>
    <div class="render-status" id="render-status-text">Generating subtitles‚Ä¶</div>
    <div class="download-area" id="download-area" style="display:none;">
      <a id="download-link" class="btn btn-success" download>üì• Download Video</a>
      <br/><br/>
      <button class="btn btn-outline" onclick="closeRenderOverlay()">Close</button>
    </div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script src="script.js?v=2"></script>
</body>
</html>
